"use strict";(self.webpackChunkstrengthjournal_app=self.webpackChunkstrengthjournal_app||[]).push([[395],{395:(L,u,s)=>{s.r(u),s.d(u,{ProfileModule:()=>E});var r=s(3075),f=s(8745),t=s(5e3),m=s(8505),g=s(6580),d=s(520),h=s(946);let c=(()=>{class e extends g._{constructor(o,i){super(o),this.config=i}getCountries(){return this.http.get(`${this.BASE_URL}/profile/countries`)}getSettings(){return this.http.get(`${this.BASE_URL}/profile/settings`)}updateSettings(o){return this.http.post(`${this.BASE_URL}/profile/settings`,o).pipe((0,m.b)(()=>{this.config.update(o)}))}resetPasword(){return this.http.put(`${this.BASE_URL}/profile/password-reset`,null)}updateEmail(o){return this.http.put(`${this.BASE_URL}/profile/email`,{newEmail:o})}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(d.eN),t.LFG(h.E))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=s(3300),a=s(1958),b=s(3949),p=s(9808);function Z(e,n){if(1&e&&(t.TgZ(0,"option",20),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.Q6J("value",o.code),t.xp6(1),t.Oqu(o.name)}}function C(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"form",9),t.NdJ("ngSubmit",function(){return t.CHM(o),t.oxw().onSubmit()}),t.TgZ(1,"div")(2,"label"),t._uU(3,"Country"),t.qZA(),t.TgZ(4,"select",10),t.YNc(5,Z,2,2,"option",11),t.qZA()(),t.TgZ(6,"div",4)(7,"label"),t._uU(8,"Preferred Weight Unit"),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"label",12),t._UZ(11,"input",13),t.TgZ(12,"span",14),t._uU(13," lbs "),t.qZA()(),t.TgZ(14,"label",12),t._UZ(15,"input",15),t.TgZ(16,"span",14),t._uU(17," kg "),t.qZA()()(),t.TgZ(18,"div",4)(19,"label"),t._uU(20,"Communication Preferences"),t.qZA(),t._UZ(21,"br"),t.TgZ(22,"label",16),t._UZ(23,"input",17),t.TgZ(24,"span",14),t._uU(25,"I would like to receive promotional emails from Strength Journal"),t.qZA()()(),t.TgZ(26,"div")(27,"button",18),t._uU(28,"Save"),t.qZA(),t.TgZ(29,"button",19),t._uU(30,"Cancel"),t.qZA()()()}if(2&e){const o=t.oxw();t.Q6J("formGroup",o.settingsForm),t.xp6(5),t.Q6J("ngForOf",o.countryList)}}function U(e,n){1&e&&(t.TgZ(0,"div",21)(1,"div",22)(2,"span",23),t._uU(3,"Loading..."),t.qZA()()())}let y=(()=>{class e{constructor(o,i,l){this.profile=o,this.toast=i,this.route=l,this.settingsForm=new r.cw({preferredWeightUnit:new r.NI(""),consentCEM:new r.NI(""),countryCode:new r.NI("")}),this.emailFormControl=new r.NI(localStorage.getItem("app_username")),this.subs=new f.Y}ngOnDestroy(){this.subs.unsubscribe()}ngOnInit(){this.settings=this.route.snapshot.data.profile.settings,this.countryList=this.route.snapshot.data.profile.countryList,this.settingsForm.setValue({preferredWeightUnit:this.settings.preferredWeightUnit,consentCEM:this.settings.consentCEM,countryCode:this.settings.countryCode})}onSubmit(){this.subs.sink=this.profile.updateSettings({preferredWeightUnit:this.settingsForm.value.preferredWeightUnit,consentCEM:1==this.settingsForm.value.consentCEM,countryCode:this.settingsForm.value.countryCode}).subscribe(()=>{this.toast.setToast({message:"Profile updated",domClass:"bg-success text-light"})})}resetPassword(){this.subs.sink=this.profile.resetPasword().subscribe(()=>{this.toast.setToast({message:"Password reset sent",domClass:"bg-success text-light"})})}updateEmail(){const o=this.emailFormControl.value;this.subs.sink=this.profile.updateEmail(o).subscribe(()=>{this.toast.setToast({message:"Email updated successfully",domClass:"bg-success text-light"}),localStorage.setItem("app_username",o),location.reload()})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(c),t.Y36(v.k),t.Y36(a.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-profile"]],decls:18,vars:2,consts:[[1,"h3","mb-3"],[1,"row"],[1,"col-12"],["cardTitle","Identity and Access"],[1,"mb-3","error-placeholder"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],["cardTitle","Profile Settings"],[3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["loading",""],[3,"formGroup","ngSubmit"],["formControlName","countryCode",1,"form-control","mb-3"],[3,"value",4,"ngFor","ngForOf"],[1,"form-check","form-check-inline"],["type","radio","name","preferredWeightUnit","value","lbs","formControlName","preferredWeightUnit",1,"form-check-input"],[1,"form-check-label"],["type","radio","name","preferredWeightUnit","value","kg","formControlName","preferredWeightUnit",1,"form-check-input"],[1,"form-check","m-0"],["type","checkbox","id","consentCEM","formControlName","consentCEM",1,"form-check-input"],["type","submit",1,"btn","btn-sm","btn-primary"],["routerLink","/",1,"btn","btn-sm","btn-secondary"],[3,"value"],[1,"mb-2","text-center"],["role","status",1,"spinner-grow","me-2"],[1,"sr-only"]],template:function(o,i){if(1&o&&(t.TgZ(0,"h1",0),t._uU(1,"Profile"),t.qZA(),t.TgZ(2,"div",1)(3,"div",2)(4,"app-card",3)(5,"div",4)(6,"label"),t._uU(7,"Reset Password"),t.qZA(),t.TgZ(8,"p"),t._uU(9," You will receive a link in your email with password reset instructions. "),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return i.resetPassword()}),t._uU(11,"Reset Password"),t.qZA()()()()(),t.TgZ(12,"div",1)(13,"div",2)(14,"app-card",6),t.YNc(15,C,31,2,"form",7),t.YNc(16,U,4,0,"ng-template",null,8,t.W1O),t.qZA()()()),2&o){const l=t.MAs(17);t.xp6(15),t.Q6J("ngIf",i.settings&&i.countryList)("ngIfElse",l)}},directives:[b.A,p.O5,r._Y,r.JL,r.sg,r.EJ,r.JJ,r.u,p.sg,r.YN,r.Kr,r._,r.Fj,r.Wl,a.rH],styles:[""]}),e})();var P=s(4466),T=s(4128),A=s(4004);const S=[{path:"",component:y,resolve:{profile:(()=>{class e{constructor(o){this.profile=o}resolve(o,i){const l=this.profile.getSettings(),F=this.profile.getCountries();return(0,T.D)([l,F]).pipe((0,A.U)(([w,I])=>({settings:w,countryList:I})))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(c))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}];let E=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[P.m,a.Bz.forChild(S)]]}),e})()}}]);